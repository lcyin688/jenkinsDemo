{"version":3,"sources":["assets/cases/dragonbones/DragonBonesCtrl.js"],"names":["cc","runtime","NORMAL_ANIMATION_GROUP","AIM_ANIMATION_GROUP","ATTACK_ANIMATION_GROUP","JUMP_SPEED","NORMALIZE_MOVE_SPEED","MAX_MOVE_SPEED_FRONT","MAX_MOVE_SPEED_BACK","WEAPON_R_LIST","WEAPON_L_LIST","SKINS","GROUND","G","Class","Component","editor","requireComponent","dragonBones","ArmatureDisplay","properties","touchHandler","type","Node","upButton","downButton","leftButton","rightButton","weaponArmature","skinArmature","_bullets","_left","_right","_isJumpingA","_isJumpingB","_isSquating","_isAttackingA","_isAttackingB","_weaponRIndex","_weaponLIndex","_skinIndex","_faceDir","_aimDir","_moveDir","_aimRadian","_speedX","_speedY","_armature","_armatureDisplay","_weaponR","_weaponL","_aimState","_walkState","_attackState","_target","v2","onLoad","getComponent","armature","addEventListener","EventObject","FADE_IN_COMPLETE","_animationEventHandler","FADE_OUT_COMPLETE","COMPLETE","getSlot","childArmature","FRAME_EVENT","_frameEventHandler","i","length","armatureName","_updateAnimation","on","EventType","TOUCH_START","event","_mouseDown_","touches","getTouches","touchLoc","getLocation","aim","x","y","attack","TOUCH_END","TOUCH_MOVE","jump","squat","TOUCH_CANCEL","_updateMove","systemEvent","SystemEvent","KEY_DOWN","_keyHandler","keyCode","KEY_UP","isDown","macro","KEY","a","left","d","right","w","up","s","down","q","switchWeaponR","e","switchWeaponL","space","dir","move","animation","fadeIn","isSquating","isAttacking","removeEventListener","newWeaponName","factory","CCFactory","getInstance","buildArmature","switchSkin","skinName","skinData","getArmatureData","defaultSkin","replaceSkin","node","parent","convertToNodeSpaceAR","update","dt","_updatePosition","_updateAim","_updateAttack","_enterFrameHandler","onDisable","bullet","enabled","addBullet","push","splice","animationState","name","resetToPose","localPoint","bone","global","display","globalPoint","convertToWorldSpace","_fire","firePoint","Math","random","effect","radian","PI","DragonBullet","init","timeScale","minX","visibleRect","width","maxX","scaleX","aimOffsetY","getBone","scaleY","atan2","aimDir","weight","abs","invalidUpdate","AnimationFadeOutMode","SameGroup","autoFadeOutTime","fadeTotalTime","_effect","parentNode","speed","position","cos","sin","thePos","playAnimation","armatureNode","setPosition","angle","DEG","effectDisplay","addChild","worldPos","convertToWorldSpaceAR","getPosition","height","doClean","removeFromParent"],"mappings":"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","sourceRoot":"/","sourcesContent":["if (!cc.runtime) {\n// runtime not support dragonbones.\n\nvar NORMAL_ANIMATION_GROUP = \"normal\";\nvar AIM_ANIMATION_GROUP = \"aim\";\nvar ATTACK_ANIMATION_GROUP = \"attack\";\nvar JUMP_SPEED = -20;\nvar NORMALIZE_MOVE_SPEED = 3.6;\nvar MAX_MOVE_SPEED_FRONT = NORMALIZE_MOVE_SPEED * 1.4;\nvar MAX_MOVE_SPEED_BACK = NORMALIZE_MOVE_SPEED * 1.0;\nvar WEAPON_R_LIST = [\"weapon_1502b_r\", \"weapon_1005\", \"weapon_1005b\", \"weapon_1005c\", \"weapon_1005d\", \"weapon_1005e\"];\nvar WEAPON_L_LIST = [\"weapon_1502b_l\", \"weapon_1005\", \"weapon_1005b\", \"weapon_1005c\", \"weapon_1005d\"];\nvar SKINS = [\"mecha_1502b\", \"skin_a\", \"skin_b\", \"skin_c\"];\nvar GROUND = -200;\nvar G = -0.6;\n\ncc.Class({\n    extends: cc.Component,\n    editor: {\n        requireComponent: dragonBones.ArmatureDisplay\n    },\n\n    properties: {\n        touchHandler : {\n            default: null,\n            type: cc.Node\n        },\n\n        upButton: {\n            default: null,\n            type: cc.Node\n        },\n\n        downButton: {\n            default: null,\n            type: cc.Node\n        },\n\n        leftButton: {\n            default: null,\n            type: cc.Node\n        },\n\n        rightButton: {\n            default: null,\n            type: cc.Node\n        },\n\n        weaponArmature: {\n            default: null,\n            type: dragonBones.ArmatureDisplay\n        },\n\n        skinArmature: {\n            default: null,\n            type: dragonBones.ArmatureDisplay\n        },\n\n        _bullets : [],\n        _left : false,\n        _right : false,\n        _isJumpingA : false,\n        _isJumpingB : false,\n        _isSquating : false,\n        _isAttackingA : false,\n        _isAttackingB : false,\n        _weaponRIndex : 0,\n        _weaponLIndex : 0,\n        _skinIndex: 0,\n        _faceDir : 1,\n        _aimDir : 0,\n        _moveDir : 0,\n        _aimRadian : 0,\n        _speedX : 0,\n        _speedY : 0,\n        _armature : null,\n        _armatureDisplay : null,\n        _weaponR : null,\n        _weaponL : null,\n        _aimState : null,\n        _walkState : null,\n        _attackState : null,\n        _target : cc.v2(0, 0),\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this._armatureDisplay = this.getComponent(dragonBones.ArmatureDisplay);\n        this._armature = this._armatureDisplay.armature();\n\n        this._armatureDisplay.addEventListener(dragonBones.EventObject.FADE_IN_COMPLETE, this._animationEventHandler, this);\n        this._armatureDisplay.addEventListener(dragonBones.EventObject.FADE_OUT_COMPLETE, this._animationEventHandler, this);\n        this._armatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE, this._animationEventHandler, this);\n\n        this._weaponR = this._armature.getSlot('weapon_r').childArmature;\n        this._weaponL = this._armature.getSlot('weapon_l').childArmature;\n        this._weaponR.addEventListener(dragonBones.EventObject.FRAME_EVENT, this._frameEventHandler, this);\n        this._weaponL.addEventListener(dragonBones.EventObject.FRAME_EVENT, this._frameEventHandler, this);\n\n        // load all skin data\n        for (let i = 1; i < SKINS.length; i++) {\n            this.skinArmature.armatureName = SKINS[i];\n        }\n\n        for (let i = 1; i < WEAPON_R_LIST.length; i++) {\n            this.weaponArmature.armatureName = WEAPON_R_LIST[i];\n        }\n\n        this._updateAnimation();\n\n        if (this.touchHandler) {\n            // touch events\n            this.touchHandler.on(cc.Node.EventType.TOUCH_START, event => {\n                this._mouseDown_ = true;\n                var touches = event.getTouches();\n                var touchLoc = touches[0].getLocation();\n                this.aim(touchLoc.x, touchLoc.y);\n                this.attack(true);\n            }, this);\n            this.touchHandler.on(cc.Node.EventType.TOUCH_END, event => {\n                this._mouseDown_ = false;\n                this.attack(false);\n            }, this);\n            this.touchHandler.on(cc.Node.EventType.TOUCH_MOVE, event => {\n                var touches = event.getTouches();\n                var touchLoc = touches[0].getLocation();\n                this.aim(touchLoc.x, touchLoc.y);\n            }, this);\n        }\n\n        if (this.upButton) {\n            this.upButton.on(cc.Node.EventType.TOUCH_START, event => {\n                this.jump();\n            }, this);\n        }\n\n        if (this.downButton) {\n            this.downButton.on(cc.Node.EventType.TOUCH_START, event => {\n                this.squat(true);\n            }, this);\n            this.downButton.on(cc.Node.EventType.TOUCH_END, event => {\n                this.squat(false);\n            }, this);\n            this.downButton.on(cc.Node.EventType.TOUCH_CANCEL, event => {\n                this.squat(false);\n            }, this);\n        }\n\n        if (this.leftButton) {\n            this.leftButton.on(cc.Node.EventType.TOUCH_START, event => {\n                this._left = true;\n                this._updateMove(-1);\n            }, this);\n            this.leftButton.on(cc.Node.EventType.TOUCH_END, event => {\n                this._left = false;\n                this._updateMove(-1);\n            }, this);\n            this.leftButton.on(cc.Node.EventType.TOUCH_CANCEL, event => {\n                this._left = false;\n                this._updateMove(-1);\n            }, this);\n        }\n\n        if (this.rightButton) {\n            this.rightButton.on(cc.Node.EventType.TOUCH_START, event => {\n                this._right = true;\n                this._updateMove(1);\n            }, this);\n            this.rightButton.on(cc.Node.EventType.TOUCH_END, event => {\n                this._right = false;\n                this._updateMove(1);\n            }, this);\n            this.rightButton.on(cc.Node.EventType.TOUCH_CANCEL, event => {\n                this._right = false;\n                this._updateMove(1);\n            }, this);\n        }\n\n        // keyboard events\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (event) {\n            this._keyHandler(event.keyCode, true);\n        }, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, function (event) {\n            this._keyHandler(event.keyCode, false);\n        }, this);\n    },\n\n    _keyHandler: function(keyCode, isDown) {\n        switch(keyCode) {\n            case cc.macro.KEY.a:\n            case cc.macro.KEY.left:\n                this._left = isDown;\n                this._updateMove(-1);\n                break;\n            case cc.macro.KEY.d:\n            case cc.macro.KEY.right:\n                this._right = isDown;\n                this._updateMove(1);\n                break;\n            case cc.macro.KEY.w:\n            case cc.macro.KEY.up:\n                if (isDown) {\n                    this.jump();\n                }\n                break;\n            case cc.macro.KEY.s:\n            case cc.macro.KEY.down:\n                this.squat(isDown);\n                break;\n            case cc.macro.KEY.q:\n                if (isDown) {\n                    this.switchWeaponR();\n                }\n                break;\n            case cc.macro.KEY.e:\n                if (isDown) {\n                    this.switchWeaponL();\n                }\n                break;\n            case cc.macro.KEY.space:\n                if (isDown) {\n                    this.switchWeaponR();\n                    this.switchWeaponL();\n                }\n                break;\n            default:\n                return;\n        }\n    },\n\n    _updateMove : function (dir) {\n        if (this._left && this._right) {\n            this.move(dir);\n        } else if (this._left) {\n            this.move(-1);\n        } else if (this._right) {\n            this.move(1);\n        } else {\n            this.move(0);\n        }\n    },\n\n    move : function(dir) {\n        if (this._moveDir === dir) {\n            return;\n        }\n\n        this._moveDir = dir;\n        this._updateAnimation();\n    },\n\n    jump : function () {\n        if (this._isJumpingA) {\n            return;\n        }\n\n        this._isJumpingA = true;\n        this._armature.animation.fadeIn(\"jump_1\", -1, -1, 0, NORMAL_ANIMATION_GROUP);\n        this._walkState = null;\n    },\n\n    squat : function(isSquating) {\n        if (this._isSquating === isSquating) {\n            return;\n        }\n\n        this._isSquating = isSquating;\n        this._updateAnimation();\n    },\n\n    attack : function (isAttacking) {\n        if (this._isAttackingA == isAttacking) {\n            return;\n        }\n\n        this._isAttackingA = isAttacking;\n    },\n\n    switchWeaponL : function() {\n        this._weaponL.removeEventListener(dragonBones.EventObject.FRAME_EVENT, this._frameEventHandler, this);\n\n        this._weaponLIndex++;\n        if (this._weaponLIndex >= WEAPON_L_LIST.length) {\n            this._weaponLIndex = 0;\n        }\n\n        var newWeaponName = WEAPON_L_LIST[this._weaponLIndex];\n        let factory = dragonBones.CCFactory.getInstance();\n        this._weaponL = factory.buildArmature(newWeaponName);\n        this._armature.getSlot('weapon_l').childArmature = this._weaponL;\n\n        this._weaponL.addEventListener(dragonBones.EventObject.FRAME_EVENT, this._frameEventHandler, this);\n    },\n\n    switchWeaponR : function() {\n        this._weaponR.removeEventListener(dragonBones.EventObject.FRAME_EVENT, this._frameEventHandler, this);\n\n        this._weaponRIndex++;\n        if (this._weaponRIndex >= WEAPON_R_LIST.length) {\n            this._weaponRIndex = 0;\n        }\n\n        var newWeaponName = WEAPON_R_LIST[this._weaponRIndex];\n        let factory = dragonBones.CCFactory.getInstance();\n        this._weaponR = factory.buildArmature(newWeaponName);\n        this._armature.getSlot('weapon_r').childArmature = this._weaponR;\n\n        this._weaponR.addEventListener(dragonBones.EventObject.FRAME_EVENT, this._frameEventHandler, this);\n    },\n\n    switchSkin : function () {\n        this._skinIndex++;\n        if (this._skinIndex >= SKINS.length)\n        {\n            this._skinIndex = 0;\n        }\n        let skinName = SKINS[this._skinIndex];\n        let factory = dragonBones.CCFactory.getInstance();\n        let skinData = factory.getArmatureData(skinName).defaultSkin;\n        factory.replaceSkin(this._armatureDisplay.armature(), skinData, false, [\"weapon_l\", \"weapon_r\"]);\n    },\n\n    aim : function(x, y) {\n        if (this._aimDir === 0) {\n            this._aimDir = 10;\n        }\n\n        this._target = this.node.parent.convertToNodeSpaceAR(cc.v2(x, y));\n    },\n\n    update : function (dt) {\n        this._updatePosition();\n        this._updateAim();\n        this._updateAttack();\n        this._enterFrameHandler(dt);\n    },\n\n    onDisable : function() {\n        // clean the bullets\n        for (var i = this._bullets.length - 1; i >= 0; i--)\n        {\n            var bullet = this._bullets[i];\n            bullet.enabled = false;\n        }\n        this._bullets = [];\n    },\n\n    addBullet : function(bullet) {\n        this._bullets.push(bullet);\n    },\n\n    _enterFrameHandler : function (dt) {\n        for (var i = this._bullets.length - 1; i >= 0; i--)\n        {\n            var bullet = this._bullets[i];\n            if (bullet.update())\n            {\n                this._bullets.splice(i, 1);\n            }\n        }\n    },\n\n    _animationEventHandler: function (event) {\n        if (event.type === dragonBones.EventObject.FADE_IN_COMPLETE) {\n            if (event.animationState.name === \"jump_1\") {\n                this._isJumpingB = true;\n                this._speedY = -JUMP_SPEED;\n\n                if (this._moveDir != 0)\n                {\n                    if (this._moveDir * this._faceDir > 0) \n                    {\n                        this._speedX = MAX_MOVE_SPEED_FRONT * this._faceDir;\n                    }\n                    else \n                    {\n                        this._speedX = -MAX_MOVE_SPEED_BACK * this._faceDir;\n                    }\n                }\n\n                this._armature.animation.fadeIn(\"jump_2\", -1, -1, 0, NORMAL_ANIMATION_GROUP).resetToPose = false;\n            } else if (event.animationState.name === \"jump_4\") {\n                this._updateAnimation();\n            }\n        }\n        else if (event.type === dragonBones.EventObject.FADE_OUT_COMPLETE) {\n            if (event.animationState.name === \"attack_01\") {\n                this._isAttackingB = false;\n                this._attackState = null;\n            }\n        }\n        else if (event.type === dragonBones.EventObject.COMPLETE) {\n            if (event.animationState.name === \"jump_4\") {\n                this._isJumpingA = false;\n                this._isJumpingB = false;\n                this._updateAnimation();\n            }\n        }\n    },\n\n    _frameEventHandler : function (event) {\n        if (event.name === \"fire\") {\n            // var firePointBone = event.armature.getBone(\"firePoint\");\n            var localPoint = cc.v2(event.bone.global.x, event.bone.global.y);\n\n            var display = event.armature.display;\n            var globalPoint = display.node.convertToWorldSpace(localPoint);\n\n            this._fire(globalPoint);\n        }\n    },\n\n    _fire : function (firePoint) {\n        firePoint.x += Math.random() * 2 - 1;\n        firePoint.y += Math.random() * 2 - 1;\n\n        var armature = this._armatureDisplay.buildArmature(\"bullet_01\");\n        var effect = this._armatureDisplay.buildArmature(\"fire_effect_01\");\n        var radian = this._faceDir < 0 ? Math.PI - this._aimRadian : this._aimRadian;\n        var bullet = new DragonBullet();\n        bullet.init(this.node.parent, armature, effect, radian + Math.random() * 0.02 - 0.01, 40, firePoint);\n        this.addBullet(bullet);\n    },\n\n    _updateAnimation : function() {\n        if (this._isJumpingA) {\n            return;\n        }\n\n        if (this._isSquating) {\n            this._speedX = 0;\n            this._armature.animation.fadeIn(\"squat\", -1, -1, 0, NORMAL_ANIMATION_GROUP).resetToPose = false;\n            this._walkState = null;\n            return;\n        }\n\n        if (this._moveDir === 0) {\n            this._speedX = 0;\n            this._armature.animation.fadeIn(\"idle\", -1, -1, 0, NORMAL_ANIMATION_GROUP).resetToPose = false;\n            this._walkState = null;\n        } else {\n            if (!this._walkState) {\n                this._walkState = this._armature.animation.fadeIn(\"walk\", -1, -1, 0, NORMAL_ANIMATION_GROUP);\n                this._walkState.resetToPose = false;\n            }\n\n            if (this._moveDir * this._faceDir > 0) {\n                this._walkState.timeScale = MAX_MOVE_SPEED_FRONT / NORMALIZE_MOVE_SPEED;\n            } else {\n                this._walkState.timeScale = -MAX_MOVE_SPEED_BACK / NORMALIZE_MOVE_SPEED;\n            }\n\n            if (this._moveDir * this._faceDir > 0) {\n                this._speedX = MAX_MOVE_SPEED_FRONT * this._faceDir;\n            } else {\n                this._speedX = -MAX_MOVE_SPEED_BACK * this._faceDir;\n            }\n        }\n    },\n\n    _updatePosition : function() {\n        if (this._speedX !== 0) {\n            this.node.x += this._speedX;\n            var minX = -cc.visibleRect.width / 2;\n            var maxX = cc.visibleRect.width / 2;\n            if (this.node.x < minX) {\n                this.node.x = minX;\n            } else if (this.node.x > maxX) {\n                this.node.x = maxX;\n            }\n        }\n\n        if (this._speedY != 0) {\n            if (this._speedY > 5 && this._speedY + G <= 5) {\n                this._armature.animation.fadeIn(\"jump_3\", -1, -1, 0, NORMAL_ANIMATION_GROUP).resetToPose = false;\n            }\n\n            this._speedY += G;\n            this.node.y += this._speedY;\n            if (this.node.y < GROUND) {\n                this.node.y = GROUND;\n                this._speedY = 0;\n                this._armature.animation.fadeIn(\"jump_4\", -1, -1, 0, NORMAL_ANIMATION_GROUP).resetToPose = false;\n            }\n        }\n    },\n\n    _updateAim : function () {\n        if (!this._mouseDown_) return;\n\n        if (this._aimDir === 0) {\n            return;\n        }\n\n        this._faceDir = this._target.x > this.node.x ? 1 : -1;\n        if (this.node.scaleX * this._faceDir < 0) {\n            this.node.scaleX *= -1;\n            if (this._moveDir) {\n                this._updateAnimation();\n            }\n        }\n\n        var aimOffsetY = this._armature.getBone(\"chest\").global.y * this.node.scaleY;\n\n        if (this._faceDir > 0) {\n            this._aimRadian = Math.atan2(this._target.y - this.node.y - aimOffsetY, this._target.x - this.node.x);\n        } else {\n            this._aimRadian = Math.PI - Math.atan2(this._target.y - this.node.y - aimOffsetY, this._target.x - this.node.x);\n            if (this._aimRadian > Math.PI) {\n                this._aimRadian -= Math.PI * 2;\n            }\n        }\n\n        let aimDir = 0;\n        if (this._aimRadian > 0) {\n            aimDir = 1;\n        } else {\n            aimDir = -1;\n        }\n\n        if (this._aimDir != aimDir) {\n            this._aimDir = aimDir;\n\n            // Animation mixing.\n            if (this._aimDir >= 0) {\n                this._aimState = this._armature.animation.fadeIn(\n                    \"aim_up\", -1.0, -1,\n                    0, AIM_ANIMATION_GROUP);\n            } else {\n                this._aimState = this._armature.animation.fadeIn(\n                    \"aim_down\", -1.0, -1,\n                    0, AIM_ANIMATION_GROUP);\n            }\n\n            this._aimState.resetToPose = false;\n        }\n\n        this._aimState.weight = Math.abs(this._aimRadian / Math.PI * 2);\n\n        //_armature.invalidUpdate(\"pelvis\"); // Only update bone mask.\n        this._armature.invalidUpdate();\n    },\n\n    _updateAttack : function() {\n        if (!this._isAttackingA || this._isAttackingB) {\n            return;\n        }\n\n        this._isAttackingB = true;\n\n        // Animation mixing.\n        this._attackState = this._armature.animation.fadeIn(\n            \"attack_01\", -1.0, -1,\n            0, ATTACK_ANIMATION_GROUP, dragonBones.AnimationFadeOutMode.SameGroup\n        );\n\n        this._attackState.resetToPose = false;\n        this._attackState.autoFadeOutTime = this._attackState.fadeTotalTime;\n    }\n});\n\n\nvar DragonBullet = cc.Class({\n    name: 'DragonBullet',\n    _speedX : 0,\n    _speedY : 0,\n\n    _armature : null,\n    _armatureDisplay : null,\n    _effect : null,\n\n    init : function (parentNode, armature, effect, radian, speed, position) {\n        this._speedX = Math.cos(radian) * speed;\n        this._speedY = Math.sin(radian) * speed;\n        var thePos = parentNode.convertToNodeSpaceAR(position);\n\n        armature.playAnimation(\"idle\");\n        \n        let armatureNode = armature.node;\n        armatureNode.setPosition(thePos);\n        armatureNode.angle = radian * cc.macro.DEG;\n\n        this._armature = armature;\n        \n        if (effect) {\n            this._effect = effect;\n            var effectDisplay = this._effect.node;\n            effectDisplay.angle = radian * cc.macro.DEG;\n            effectDisplay.setPosition(thePos);\n            effectDisplay.scaleX = 1 + Math.random() * 1;\n            effectDisplay.scaleY = 1 + Math.random() * 0.5;\n            if (Math.random() < 0.5) {\n                effectDisplay.scaleY *= -1;\n            }\n\n            this._effect.playAnimation(\"idle\");\n\n            parentNode.addChild(effectDisplay);\n        }\n\n        parentNode.addChild(armatureNode);\n    },\n\n    update : function() {\n        let armatureNode = this._armature.node;\n\n        armatureNode.x += this._speedX;\n        armatureNode.y += this._speedY;\n\n        var worldPos = armatureNode.parent.convertToWorldSpaceAR(armatureNode.getPosition());\n        if (\n            worldPos.x < -100 || worldPos.x >= cc.visibleRect.width + 100 ||\n            worldPos.y < -100 || worldPos.y >= cc.visibleRect.height + 100\n        ) {\n            this.doClean();\n            return true;\n        }\n\n        return false;\n    },\n\n    onDisable : function () {\n        this.doClean();\n    },\n\n    doClean : function() {\n        this._armature.node.removeFromParent();\n\n        if (this._effect) {\n            this._effect.node.removeFromParent();\n        }\n    }\n});\n} // end of !cc.runtime\n"]}