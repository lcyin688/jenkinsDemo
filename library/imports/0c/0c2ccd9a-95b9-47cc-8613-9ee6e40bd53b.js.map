{"version":3,"sources":["assets/cases/05_scripting/10_network/downloader-web/downloader-audio.js"],"names":["i18n","require","cc","Class","Component","properties","remindLabel","type","Label","inputUrlBox","EditBox","_audioPlayer","_audioUrl","onLoad","textKey","node","getComponent","startLoad","string","assetManager","loadRemote","audioLoadComplete","bind","t","err","res","console","log","setAudioTask","update","currentTime","onDisable","stopAllAudio"],"mappings":";;;;;;AAAA,IAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AAEAC,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAGLC,UAAU,EAAE;IACRC,WAAW,EAAE;MACT,WAAS,IADA;MAETC,IAAI,EAAEL,EAAE,CAACM;IAFA,CADL;IAKRC,WAAW,EAAE;MACT,WAAS,IADA;MAETF,IAAI,EAAEL,EAAE,CAACQ;IAFA,CALL;IASRC,YAAY,EAAE,IATN;IAURC,SAAS,EAAE;EAVH,CAHP;EAgBLC,MAhBK,oBAgBK;IACN,KAAKP,WAAL,CAAiBQ,OAAjB,GAA2B,EAA3B;IACA,KAAKH,YAAL,GAAoB,KAAKI,IAAL,CAAUC,YAAV,CAAuB,WAAvB,CAApB;EACH,CAnBI;EAqBLC,SArBK,uBAqBQ;IACT;IACA,KAAKL,SAAL,GAAiB,KAAKH,WAAL,CAAiBS,MAAlC,CAFS,CAGT;;IACA,IAAI,KAAKN,SAAT,EAAoB;MAChBV,EAAE,CAACiB,YAAH,CAAgBC,UAAhB,CAA2B,KAAKR,SAAhC,EAA2C,KAAKS,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAA3C;MACA,KAAKhB,WAAL,CAAiBQ,OAAjB,GAA2Bd,IAAI,CAACuB,CAAL,CAAO,mDAAP,CAA3B;IACH,CAHD,MAIK;MACD,KAAKjB,WAAL,CAAiBQ,OAAjB,GAA2Bd,IAAI,CAACuB,CAAL,CAAO,oDAAP,CAA3B;IACH;EACJ,CAhCI;EAkCLF,iBAlCK,6BAkCcG,GAlCd,EAkCmBC,GAlCnB,EAkCwB;IACzB,IAAID,GAAG,IAAI,CAACC,GAAZ,EAAiB;MACbC,OAAO,CAACC,GAAR,CAAYH,GAAZ;MACA,KAAKlB,WAAL,CAAiBQ,OAAjB,GAA4Bd,IAAI,CAACuB,CAAL,CAAO,qDAAP,CAA5B;MACA;IACH;;IACD,KAAKjB,WAAL,CAAiBQ,OAAjB,GAA2Bd,IAAI,CAACuB,CAAL,CAAO,qDAAP,CAA3B,CANyB,CAOzB;;IACA,KAAKZ,YAAL,CAAkBiB,YAAlB,CAA+BH,GAA/B;EACH,CA3CI;EA6CLI,MA7CK,oBA6CK;IACN,KAAKlB,YAAL,CAAkBmB,WAAlB;EACH,CA/CI;EAiDLC,SAjDK,uBAiDO;IACR,KAAKpB,YAAL,CAAkBqB,YAAlB;EACH;AAnDI,CAAT","sourceRoot":"/","sourcesContent":["const i18n = require('i18n');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        remindLabel: {\n            default: null,\n            type: cc.Label\n        },\n        inputUrlBox: {\n            default: null,\n            type: cc.EditBox\n        },\n        _audioPlayer: null,\n        _audioUrl: 'http://tools.itharbors.com/christmas/res/sounds/ss.mp3',\n    },\n\n    onLoad () {\n        this.remindLabel.textKey = '';\n        this._audioPlayer = this.node.getComponent('AudioCtrl');\n    },\n\n    startLoad () {\n        // set url\n        this._audioUrl = this.inputUrlBox.string;\n        // download audio\n        if (this._audioUrl) {\n            cc.assetManager.loadRemote(this._audioUrl, this.audioLoadComplete.bind(this));\n            this.remindLabel.textKey = i18n.t('cases/05_scripting/11_network/download-web.fire.2');\n        }\n        else {\n            this.remindLabel.textKey = i18n.t('cases/05_scripting/11_network/download-web.fire.10');\n        }\n    },\n\n    audioLoadComplete (err, res) {\n        if (err || !res) {\n            console.log(err);\n            this.remindLabel.textKey =  i18n.t('cases/05_scripting/11_network/download-web.fire.5.1');\n            return;\n        }\n        this.remindLabel.textKey = i18n.t('cases/05_scripting/11_network/download-web.fire.4.1');\n        // return back a AudioClip\n        this._audioPlayer.setAudioTask(res);\n    },\n\n    update () {\n        this._audioPlayer.currentTime();\n    },\n\n    onDisable() {\n        this._audioPlayer.stopAllAudio();\n    }\n});\n"]}