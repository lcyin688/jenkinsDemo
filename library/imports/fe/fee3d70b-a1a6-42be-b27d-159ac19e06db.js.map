{"version":3,"sources":["assets/cases/05_scripting/06_asset_loading/LoadResDir/loadResDir_example.js"],"names":["cc","Class","Component","properties","btnClearAll","Node","label","Prefab","scrollView","ScrollView","_init","_assets","_hasLoading","content","height","active","onLoad","_createLabel","text","node","instantiate","getComponent","Label","textKey","addChild","_clear","removeAllChildren","i","length","asset","assetManager","releaseAsset","onClearAll","onLoadAll","scrollToTop","resources","loadDir","err","assets","isValid","info","toString","JsonAsset","JSON","stringify","json","name","js","getClassName","onLoadSpriteFrameAll","SpriteFrame"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnClearAll: cc.Node,\n        label: cc.Prefab,\n        scrollView: cc.ScrollView\n    },\n\n    _init: function () {\n        this._assets = [];\n        this._hasLoading = false;\n        this.scrollView.content.height = 0;\n        this.btnClearAll.active = false;\n    },\n\n    onLoad: function () {\n        this._init();\n    },\n\n    _createLabel: function (text) {\n        var node = cc.instantiate(this.label);\n        var label = node.getComponent(cc.Label);\n        label.textKey = text;\n        this.scrollView.content.addChild(node);\n    },\n\n    _clear: function () {\n        this.scrollView.content.removeAllChildren(true);\n        for (var i = 0; i < this._assets.length; ++i) {\n            var asset = this._assets[i];\n            cc.assetManager.releaseAsset(asset);\n        }\n    },\n\n    onClearAll: function () {\n        this.scrollView.content.height = 0;\n        this.btnClearAll.active = false;\n        this._clear();\n    },\n\n    onLoadAll: function () {\n        if (this._hasLoading) { return; }\n        this._hasLoading = true;\n\n        this._clear();\n        this._createLabel(\"Load All Assets\");\n        this.scrollView.scrollToTop();\n        this.btnClearAll.active = false;  // 防止加载的过程中清除资源\n\n        cc.resources.loadDir(\"test_assets\", (err, assets) => {\n            if (!this.isValid) {\n                return;\n            }\n\n            this._assets = assets;\n            for (var i = 0; i < assets.length; ++i) {\n                var asset = assets[i];\n                var info = asset.toString();\n                if (!info) {\n                    if (asset instanceof cc.JsonAsset) {\n                        info = JSON.stringify(asset.json, null, 4);\n                    }\n                    else {\n                        info = info || asset.name || cc.js.getClassName(asset);\n                    }\n                }\n                this._createLabel(info);\n            }\n            this._hasLoading = false;\n            this.btnClearAll.active = true;\n        });\n    },\n\n    onLoadSpriteFrameAll: function () {\n        if (this._hasLoading) { return; }\n        this._hasLoading = true;\n\n        this._clear();\n        this._createLabel(\"Load All Sprite Frame\");\n        this.scrollView.scrollToTop();\n        this.btnClearAll.active = false;  // 防止加载的过程中清除资源\n\n        cc.resources.loadDir(\"test_assets\", cc.SpriteFrame, (err, assets) => {\n            if (!this.isValid) {\n                return;\n            }\n            this._assets = assets;\n            for (var i = 0; i < assets.length; ++i) {\n                var asset = assets[i];\n                this._createLabel(asset.name);\n            }\n            this._hasLoading = false;\n            this.btnClearAll.active = true;\n        });\n    }\n});\n"]}