{"version":3,"sources":["assets/cases/02_ui/09_videoplayer/VideoPlayerCtrl.js"],"names":["i18n","require","TipsManager","getStatus","event","cc","VideoPlayer","EventType","PLAYING","PAUSED","STOPPED","COMPLETED","META_LOADED","CLICKED","READY_TO_PLAY","Class","Component","properties","videoPlayer","statusLabel","Label","currentTime","resSwitchBtnLabel","controlButtons","Node","keep_Ratio_Switch","playVideoArea","visibility","start","init","active","sys","isBrowser","platform","WECHAT_GAME","on","play","onVideoPlayerEvent","sender","string","isPlaying","pause","toggleFullscreen","browserType","BROWSER_TYPE_MOBILE_QQ","browserVersion","test","navigator","userAgent","createTips","t","log","isFullscreen","toggleVisibility","node","keepRatioSwitch","keepAspectRatio","switchOnlineVideo","remoteURL","resourceType","ResourceType","REMOTE","switchLoaclVide","LOCAL","stop","update","toFixed","getDuration"],"mappings":";;;;;;AAAA,IAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,IAAMC,WAAW,GAAGD,OAAO,CAAC,aAAD,CAA3B;;AAEA,SAASE,SAAT,CAAoBC,KAApB,EAA2B;EACvB,QAAQA,KAAR;IACI,KAAKC,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBC,OAA9B;MACI,OAAO,SAAP;;IACJ,KAAKH,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBE,MAA9B;MACI,OAAO,QAAP;;IACJ,KAAKJ,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBG,OAA9B;MACI,OAAO,SAAP;;IACJ,KAAKL,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBI,SAA9B;MACI,OAAO,WAAP;;IACJ,KAAKN,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBK,WAA9B;MACI,OAAO,aAAP;;IACJ,KAAKP,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBM,OAA9B;MACI,OAAO,SAAP;;IACJ,KAAKR,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBO,aAA9B;MACI,OAAO,eAAP;;IACJ;MACI,OAAO,MAAP;EAhBR;AAkBH;;AAAA;AAEDT,EAAE,CAACU,KAAH,CAAS;EACL,WAASV,EAAE,CAACW,SADP;EAGLC,UAAU,EAAE;IACRC,WAAW,EAAEb,EAAE,CAACC,WADR;IAERa,WAAW,EAAEd,EAAE,CAACe,KAFR;IAGRC,WAAW,EAAEhB,EAAE,CAACe,KAHR;IAIRE,iBAAiB,EAAEjB,EAAE,CAACe,KAJd;IAKRG,cAAc,EAAElB,EAAE,CAACmB,IALX;IAMRC,iBAAiB,EAAEpB,EAAE,CAACmB,IANd;IAORE,aAAa,EAAErB,EAAE,CAACmB,IAPV;IAQRG,UAAU,EAAEtB,EAAE,CAACe;EARP,CAHP;EAcLQ,KAdK,mBAcI;IAAA;;IACL1B,WAAW,CAAC2B,IAAZ;IACA,KAAKN,cAAL,CAAoBO,MAApB,GAA6B,KAA7B;IACA,KAAKL,iBAAL,CAAuBK,MAAvB,GAAgC,EAAEzB,EAAE,CAAC0B,GAAH,CAAOC,SAAP,IAAoB3B,EAAE,CAAC0B,GAAH,CAAOE,QAAP,KAAoB5B,EAAE,CAAC0B,GAAH,CAAOG,WAAjD,CAAhC;IACA,KAAKR,aAAL,CAAmBS,EAAnB,CAAsB,UAAtB,EAAkC,YAAM;MACpC,KAAI,CAACjB,WAAL,CAAiBkB,IAAjB;IACH,CAFD;EAGH,CArBI;EAuBLC,kBAvBK,8BAuBeC,MAvBf,EAuBuBlC,KAvBvB,EAuB8B;IAC/B,KAAKe,WAAL,CAAiBoB,MAAjB,GAA0B,aAAapC,SAAS,CAACC,KAAD,CAAhD;;IACA,IAAIA,KAAK,KAAKC,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBM,OAAvC,EAAgD;MAC5C,IAAI,KAAKK,WAAL,CAAiBsB,SAAjB,EAAJ,EAAkC;QAC9B,KAAKtB,WAAL,CAAiBuB,KAAjB;MACH,CAFD,MAEO;QACH,KAAKvB,WAAL,CAAiBkB,IAAjB;MACH;IACJ,CAND,MAOK,IAAIhC,KAAK,KAAKC,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBO,aAAnC,IAAoDV,KAAK,KAAKC,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBK,WAA3F,EAAwG;MACzG,KAAKW,cAAL,CAAoBO,MAApB,GAA6B,IAA7B;MACA,KAAKJ,aAAL,CAAmBI,MAAnB,GAA4B,IAA5B;IACH,CAHI,MAIA,IAAI1B,KAAK,KAAKC,EAAE,CAACC,WAAH,CAAeC,SAAf,CAAyBC,OAAvC,EAAgD;MACjD,KAAKkB,aAAL,CAAmBI,MAAnB,GAA4B,KAA5B;IACH;EACJ,CAvCI;EAyCLY,gBAzCK,8BAyCe;IAChB,IACIrC,EAAE,CAAC0B,GAAH,CAAOC,SAAP,IACA3B,EAAE,CAAC0B,GAAH,CAAOY,WAAP,KAAuBtC,EAAE,CAAC0B,GAAH,CAAOa,sBAD9B,IAEAvC,EAAE,CAAC0B,GAAH,CAAOc,cAAP,IAAyB,GAFzB,IAGA,UAAUC,IAAV,CAAeC,SAAS,CAACC,SAAzB,CAJJ,EAKE;MACE9C,WAAW,CAAC+C,UAAZ,CAAuBjD,IAAI,CAACkD,CAAL,CAAO,8DAAP,CAAvB;MACA,OAAO7C,EAAE,CAAC8C,GAAH,CAAO,uCAAP,CAAP;IACH;;IACD,KAAKjC,WAAL,CAAiBkC,YAAjB,GAAgC,IAAhC;EACH,CApDI;EAsDLC,gBAtDK,4BAsDajD,KAtDb,EAsDoB;IACrB,KAAKc,WAAL,CAAiBoC,IAAjB,CAAsBxB,MAAtB,GAA+B,CAAC,KAAKZ,WAAL,CAAiBoC,IAAjB,CAAsBxB,MAAtD;IACA,KAAKJ,aAAL,CAAmBI,MAAnB,GAA4B,KAAKZ,WAAL,CAAiBoC,IAAjB,CAAsBxB,MAAlD;IACA,KAAKH,UAAL,CAAgBY,MAAhB,GAAyB,iBAAiB,KAAKrB,WAAL,CAAiBoC,IAAjB,CAAsBxB,MAAhE;EACH,CA1DI;EA4DLyB,eA5DK,6BA4Dc;IACf,KAAKrC,WAAL,CAAiBsC,eAAjB,GAAmC,CAAC,KAAKtC,WAAL,CAAiBsC,eAArD;EACH,CA9DI;EAgELC,iBAhEK,+BAgEgB;IACjB,KAAKvC,WAAL,CAAiBwC,SAAjB,GAA6B,yCAA7B;IACA,KAAKxC,WAAL,CAAiByC,YAAjB,GAAgCtD,EAAE,CAACC,WAAH,CAAesD,YAAf,CAA4BC,MAA5D;IACA,KAAKnC,aAAL,CAAmBI,MAAnB,GAA4B,IAA5B;EACH,CApEI;EAsELgC,eAtEK,6BAsEc;IACf,KAAK5C,WAAL,CAAiByC,YAAjB,GAAgCtD,EAAE,CAACC,WAAH,CAAesD,YAAf,CAA4BG,KAA5D;IACA,KAAKrC,aAAL,CAAmBI,MAAnB,GAA4B,IAA5B;EACH,CAzEI;EA2ELM,IA3EK,kBA2EG;IACJ,KAAKlB,WAAL,CAAiBkB,IAAjB;IACA,KAAKV,aAAL,CAAmBI,MAAnB,GAA4B,KAA5B;EACH,CA9EI;EAgFLW,KAhFK,mBAgFI;IACL,KAAKvB,WAAL,CAAiBuB,KAAjB;EACH,CAlFI;EAoFLuB,IApFK,kBAoFG;IACJ,KAAK9C,WAAL,CAAiB8C,IAAjB;EACH,CAtFI;EAwFLC,MAxFK,oBAwFK;IACN,IAAI,KAAK5C,WAAL,IAAoB,KAAKH,WAAL,CAAiBG,WAAjB,IAAgC,CAAxD,EAA2D;MACvD,KAAKA,WAAL,CAAiBkB,MAAjB,GAA0B,KAAKrB,WAAL,CAAiBG,WAAjB,CAA6B6C,OAA7B,CAAqC,CAArC,IAA0C,KAA1C,GAAkD,KAAKhD,WAAL,CAAiBiD,WAAjB,GAA+BD,OAA/B,CAAuC,CAAvC,CAA5E;IACH;EACJ;AA5FI,CAAT","sourceRoot":"/","sourcesContent":["const i18n = require('i18n');\nconst TipsManager = require('TipsManager');\n\nfunction getStatus (event) {\n    switch (event) {\n        case cc.VideoPlayer.EventType.PLAYING:\n            return 'PLAYING';\n        case cc.VideoPlayer.EventType.PAUSED:\n            return 'PAUSED';\n        case cc.VideoPlayer.EventType.STOPPED:\n            return 'STOPPED';\n        case cc.VideoPlayer.EventType.COMPLETED:\n            return 'COMPLETED';\n        case cc.VideoPlayer.EventType.META_LOADED:\n            return 'META_LOADED';\n        case cc.VideoPlayer.EventType.CLICKED:\n            return 'CLICKED';\n        case cc.VideoPlayer.EventType.READY_TO_PLAY:\n            return 'READY_TO_PLAY';\n        default:\n            return 'NONE';\n    }\n};\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        videoPlayer: cc.VideoPlayer,\n        statusLabel: cc.Label,\n        currentTime: cc.Label,\n        resSwitchBtnLabel: cc.Label,\n        controlButtons: cc.Node,\n        keep_Ratio_Switch: cc.Node,\n        playVideoArea: cc.Node,\n        visibility: cc.Label,\n    },\n\n    start () {\n        TipsManager.init();\n        this.controlButtons.active = false;\n        this.keep_Ratio_Switch.active = !(cc.sys.isBrowser || cc.sys.platform === cc.sys.WECHAT_GAME);\n        this.playVideoArea.on('touchend', () => {\n            this.videoPlayer.play();\n        });\n    },\n\n    onVideoPlayerEvent (sender, event) {\n        this.statusLabel.string = 'Status: ' + getStatus(event);\n        if (event === cc.VideoPlayer.EventType.CLICKED) {\n            if (this.videoPlayer.isPlaying()) {\n                this.videoPlayer.pause();\n            } else {\n                this.videoPlayer.play();\n            }\n        }\n        else if (event === cc.VideoPlayer.EventType.READY_TO_PLAY || event === cc.VideoPlayer.EventType.META_LOADED) {\n            this.controlButtons.active = true;\n            this.playVideoArea.active = true;\n        }\n        else if (event === cc.VideoPlayer.EventType.PLAYING) {\n            this.playVideoArea.active = false;\n        }\n    },\n\n    toggleFullscreen () {\n        if (\n            cc.sys.isBrowser &&\n            cc.sys.browserType === cc.sys.BROWSER_TYPE_MOBILE_QQ &&\n            cc.sys.browserVersion <= 7.2 &&\n            /Nexus 6/.test(navigator.userAgent)\n        ) {\n            TipsManager.createTips(i18n.t('cases/02_ui/09_videoplayer/videoPlayer.nonsupport_fullscreen'));\n            return cc.log('May be crash, so prohibit full screen');\n        }\n        this.videoPlayer.isFullscreen = true;\n    },\n\n    toggleVisibility (event) {\n        this.videoPlayer.node.active = !this.videoPlayer.node.active;\n        this.playVideoArea.active = this.videoPlayer.node.active;\n        this.visibility.string = 'Visibility: ' + this.videoPlayer.node.active;\n    },\n\n    keepRatioSwitch () {\n        this.videoPlayer.keepAspectRatio = !this.videoPlayer.keepAspectRatio;\n    },\n\n    switchOnlineVideo () {\n        this.videoPlayer.remoteURL = 'https://www.w3school.com.cn/i/movie.mp4';\n        this.videoPlayer.resourceType = cc.VideoPlayer.ResourceType.REMOTE;\n        this.playVideoArea.active = true;\n    },\n\n    switchLoaclVide () {\n        this.videoPlayer.resourceType = cc.VideoPlayer.ResourceType.LOCAL;\n        this.playVideoArea.active = true;\n    },\n\n    play () {\n        this.videoPlayer.play();\n        this.playVideoArea.active = false;\n    },\n\n    pause () {\n        this.videoPlayer.pause();\n    },\n\n    stop () {\n        this.videoPlayer.stop();\n    },\n\n    update () {\n        if (this.currentTime && this.videoPlayer.currentTime >= 0) {\n            this.currentTime.string = this.videoPlayer.currentTime.toFixed(2) + ' / ' + this.videoPlayer.getDuration().toFixed(2);\n        }\n    }\n\n});\n"]}