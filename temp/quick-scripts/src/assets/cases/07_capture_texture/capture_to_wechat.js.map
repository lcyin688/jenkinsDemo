{"version":3,"sources":["assets/cases/07_capture_texture/capture_to_wechat.js"],"names":["cc","Class","require","start","init","scheduleOnce","canvas","createCanvas","createImg","saveFile","tempCanvas","sys","platform","WECHAT_GAME","self","data","x","y","width","height","destWidth","destHeight","fileType","quality","_tempFilePath","toTempFilePathSync","log","label","string","wx","previewImage","urls","success","res"],"mappings":";;;;;;AAAAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASC,OAAO,CAAC,sBAAD,CADX;EAGLC,KAHK,mBAGI;IAAA;;IACL,KAAKC,IAAL,GADK,CAEL;;IACA,KAAKC,YAAL,CAAkB,YAAM;MACpB,IAAIC,MAAM,GAAG,KAAI,CAACC,YAAL,EAAb;;MACA,KAAI,CAACC,SAAL;;MACA,KAAI,CAACC,QAAL,CAAcH,MAAd;IACH,CAJD,EAIG,CAJH;EAKH,CAXI;EAaLG,QAbK,oBAaKC,UAbL,EAaiB;IAClB;IACA,IAAIV,EAAE,CAACW,GAAH,CAAOC,QAAP,KAAoBZ,EAAE,CAACW,GAAH,CAAOE,WAA/B,EAA4C;MACxC,IAAIC,IAAI,GAAG,IAAX;MACA,IAAIC,IAAI,GAAG;QACPC,CAAC,EAAE,CADI;QAEPC,CAAC,EAAE,CAFI;QAGPC,KAAK,EAAEZ,MAAM,CAACY,KAHP;QAIPC,MAAM,EAAEb,MAAM,CAACa,MAJR;QAKP;QACAC,SAAS,EAAEd,MAAM,CAACY,KANX;QAOPG,UAAU,EAAEf,MAAM,CAACa,MAPZ;QAQPG,QAAQ,EAAE,KARH;QASPC,OAAO,EAAE;MATF,CAAX,CAFwC,CAaxC;;MACA,IAAIC,aAAa,GAAGd,UAAU,CAACe,kBAAX,CAA8BV,IAA9B,CAApB;;MACAf,EAAE,CAAC0B,GAAH,2BAA+BF,aAA/B;MACAV,IAAI,CAACa,KAAL,CAAWC,MAAX,GAAoB,eAApB,CAhBwC,CAiBxC;;MACAC,EAAE,CAACC,YAAH,CAAgB;QACZC,IAAI,EAAE,CAACP,aAAD,CADM;QAEZQ,OAAO,EAAE,iBAACC,GAAD,EAAS;UACdjC,EAAE,CAAC0B,GAAH,CAAO,wBAAP;UACAZ,IAAI,CAACa,KAAL,CAAWC,MAAX,GAAoB,EAApB;QACH;MALW,CAAhB;IAOH,CAzBD,MA0BK;MACD,IAAId,KAAI,GAAG,IAAX;;MACAA,KAAI,CAACa,KAAL,CAAWC,MAAX,GAAoB,eAApB;MACA5B,EAAE,CAAC0B,GAAH,CAAO,eAAP;IACH;EACJ;AA9CI,CAAT","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: require('./textureRenderUtils'),\n\n    start () {\n        this.init();\n        // create the capture\n        this.scheduleOnce(() => {\n            let canvas = this.createCanvas();\n            this.createImg();\n            this.saveFile(canvas);\n        }, 1);\n    },\n\n    saveFile (tempCanvas) {\n        // This is one of the ways that could save the img to your local.\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n            let self = this;\n            let data = {\n                x: 0,\n                y: 0,\n                width: canvas.width,\n                height: canvas.height,\n                // destination file sizes\n                destWidth: canvas.width,\n                destHeight: canvas.height,\n                fileType: 'png',\n                quality: 1\n            }\n            // https://developers.weixin.qq.com/minigame/dev/api/render/canvas/Canvas.toTempFilePathSync.html\n            let _tempFilePath = tempCanvas.toTempFilePathSync(data);\n            cc.log(`Capture file success!${_tempFilePath}`);\n            self.label.string = '图片加载完成，等待本地预览';\n            // https://developers.weixin.qq.com/minigame/dev/api/media/image/wx.previewImage.html\n            wx.previewImage({\n                urls: [_tempFilePath],\n                success: (res) => {\n                    cc.log('Preview image success.');\n                    self.label.string = '';\n                }\n            });\n        }\n        else {\n            let self = this;\n            self.label.string = '该样例只支持微信小游戏平台';\n            cc.log('该样例只支持微信小游戏平台');\n        }\n    }\n});\n"]}