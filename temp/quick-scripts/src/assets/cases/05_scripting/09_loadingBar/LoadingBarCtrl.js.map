{"version":3,"sources":["assets/cases/05_scripting/09_loadingBar/LoadingBarCtrl.js"],"names":["i18n","require","cc","Class","Component","properties","progressBar","type","ProgressBar","progressTips","Label","laodBg","Node","onLoad","_urls","resource","progress","_clearAll","textKey","t","node","on","EventType","TOUCH_START","resources","load","_progressCallback","bind","_completeCallback","i","length","url","release","completedCount","totalCount","res","error","update","dt","active","enabled","id"],"mappings":"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","sourceRoot":"/","sourcesContent":["const i18n = require('i18n');\n\n//\n// 本教程主要还是体现如何使用Loader的进度条。\n//\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        progressBar: {\n            default: null,\n            type: cc.ProgressBar\n        },\n\n        progressTips: {\n            default: null,\n            type: cc.Label\n        },\n\n        laodBg: {\n            default: null,\n            type: cc.Node\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this._urls = [\n            'audio/ding',\n            'audio/cheering',\n            'audio/music_logo',\n            'test_assets/audio',\n            'loadingBar/font',\n            'loadingBar/mikado_outline_shadow',\n            'loadingBar/enligsh-chinese'\n        ];\n        this.resource = null;\n        this.progressBar.progress = 0;\n        this._clearAll();\n        this.progressTips.textKey = i18n.t(\"cases/05_scripting/10_loadingBar/LoadingBarCtrl.js.3\");\n        this.node.on(cc.Node.EventType.TOUCH_START, function () {\n            if (this.resource) { return; }\n            cc.resources.load(this._urls, this._progressCallback.bind(this), this._completeCallback.bind(this));\n        }, this);\n    },\n\n    _clearAll: function () {\n        for (var i = 0; i < this._urls.length; ++i) {\n            var url = this._urls[i];\n            cc.resources.release(url);\n        }\n    },\n\n    _progressCallback: function (completedCount, totalCount, res) {\n        this.progress = completedCount / totalCount;\n        this.resource = res;\n        this.completedCount = completedCount;\n        this.totalCount = totalCount;\n    },\n\n    _completeCallback: function (error, res) {\n\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if (!this.resource) {\n            return;\n        }\n        var progress = this.progressBar.progress;\n        if (progress >= 1) {\n            this.progressTips.textKey = i18n.t(\"cases/05_scripting/10_loadingBar/LoadingBarCtrl.js.1\");\n            this.laodBg.active = false;\n            this.progressBar.node.active = false;\n            this.enabled = false;\n            return;\n        }\n        if (progress < this.progress) {\n            progress += dt;\n        }\n        this.progressBar.progress = progress;\n        this.progressTips.textKey = i18n.t(\"cases/05_scripting/10_loadingBar/LoadingBarCtrl.js.2\")+ this.resource.id + \" (\" + this.completedCount + \"/\" + this.totalCount + \")\";\n    }\n});\n"]}