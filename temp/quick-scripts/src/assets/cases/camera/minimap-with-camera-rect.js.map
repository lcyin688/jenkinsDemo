{"version":3,"sources":["assets/cases/camera/minimap-with-camera-rect.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property, executeInEditMode} = cc._decorator;\n\n// camera z value should between camera nearClip and farClip\nconst MINI_CAMERA_Z = 100;\n\n@ccclass\n@executeInEditMode\nexport default class NewClass extends cc.Component {\n\n    @property(cc.Node)\n    target: cc.Node = null;\n\n    @property(cc.Camera)\n    miniMapCamera: cc.Camera = null;\n\n    @property(cc.Graphics)\n    cameraInfo: cc.Graphics = null;\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {}\n\n\n    cameraPos = cc.v3(0, 0, MINI_CAMERA_Z);\n    cameraOrthoSize = 1;\n\n    _tweens: cc.Tween[] = [];\n\n    start () {\n        if (!CC_EDITOR) {\n            let t = cc.tween(this.target)\n                .by(6, {angle: 360})\n                .repeatForever()\n                .start()\n            this._tweens.push(t);\n\n            t = cc.tween(this)\n                .set({cameraPos: cc.v3(0, 0, MINI_CAMERA_Z), cameraOrthoSize: cc.Canvas.instance.node.height / 2})\n                .to(6, {cameraOrthoSize: this.target.width / 2})\n                .delay(1)\n                .to(3, {cameraPos: cc.v3(100, 0, MINI_CAMERA_Z)})\n                .union()\n                .repeatForever()\n                .start()\n            this._tweens.push(t);\n        }\n        else {\n            this.cameraOrthoSize = cc.Canvas.instance.node.height / 2;\n        }\n    }\n\n    onDestroy () {\n        this._tweens.forEach(t => {\n            t.stop();\n        })\n    }\n\n    update (dt) {\n        let { width: canvasWidth, height: canvasHeight } = cc.Canvas.instance.node;\n        \n        let deviceWidth = canvasWidth, deviceHeight = canvasHeight;\n        if (!CC_EDITOR) {\n            deviceWidth = cc.game.canvas.width / cc.view._scaleX;\n            deviceHeight = cc.game.canvas.height / cc.view._scaleY;\n        }\n\n        let orthoHeight = this.cameraOrthoSize;\n        let orthoWidth = orthoHeight * (deviceWidth / deviceHeight);\n        \n        let rect = this.miniMapCamera.rect;\n        this.cameraInfo.clear();\n\n        // draw mini camera border\n        this.cameraInfo.rect((rect.x - 0.5) * deviceWidth, (rect.y - 0.5) * deviceHeight, rect.width * deviceWidth, rect.height * deviceHeight);\n        this.cameraInfo.strokeColor = cc.Color.YELLOW;\n        this.cameraInfo.stroke();\n\n        // draw mini camera ortho size\n        this.cameraInfo.rect(this.cameraPos.x - orthoWidth, this.cameraPos.y - orthoHeight, orthoWidth * 2, orthoHeight * 2);\n        this.cameraInfo.strokeColor = cc.Color.BLUE;\n        this.cameraInfo.stroke();\n        \n        this.miniMapCamera.node.position = this.cameraPos;\n        this.miniMapCamera.orthoSize = this.cameraOrthoSize;\n    }\n}\n"]}