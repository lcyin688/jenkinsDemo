
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/cases/05_scripting/06_asset_loading/AssetLoading/AssetLoading.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '65aa6czKHtKGZog+yjK1bc6', 'AssetLoading');
// cases/05_scripting/06_asset_loading/AssetLoading/AssetLoading.js

"use strict";

var _cc$Class;

var i18n = require('i18n');

cc.Class((_cc$Class = {
  "extends": cc.Component,
  properties: {
    showWindow: cc.Node,
    loadAnimTestPrefab: cc.Prefab,
    loadTips: cc.Label,
    loadList: {
      "default": [],
      type: cc.Node
    },
    assets: []
  },
  // use this for initialization
  onLoad: function onLoad() {
    // cur load Target
    this._curType = "";
    this._lastType = "";
    this._curRes = null;
    this._btnLabel = null;
    this._audioSource = null;
    this._isLoading = false; // add load res url

    this._urls = {
      Audio: "test_assets/audio",
      Txt: "test_assets/text",
      Texture: "test_assets/PurpleMonster",
      Font: "test_assets/font",
      Plist: "test_assets/atom",
      SpriteFrame: "test_assets/image",
      Prefab: "test_assets/prefab",
      Animation: "test_assets/sprite-anim",
      Scene: "test_assets/scene",
      Spine: "spineboy/spineboy",
      CORS: "https://download.cocos.com/test-case/logo.png"
    }; // registered event

    this._onRegisteredEvent();
  },
  onDestroy: function onDestroy() {},
  _onRegisteredEvent: function _onRegisteredEvent() {
    for (var i = 0; i < this.loadList.length; ++i) {
      this.loadList[i].on(cc.Node.EventType.TOUCH_END, this._onClick.bind(this));
    }
  },
  _onClick: function _onClick(event) {
    if (this._isLoading) {
      return;
    }

    this._onClear();

    this._curType = event.target.name.split('_')[1];

    if (this._lastType !== "" && this._curType === this._lastType) {
      this._onShowResClick(event);

      return;
    }

    if (this._btnLabel) {
      this._btnLabel.textKey = i18n.t("cases/05_scripting/07_asset_loading/AssetLoading.js.1") + this._lastType;
    }

    this._lastType = this._curType;
    this._btnLabel = event.target.getChildByName("Label").getComponent("cc.Label");
    this.loadTips.textKey = this._curType + " Loading....";
    this._isLoading = true;

    this._load();
  },
  _load: function _load() {
    var url = this._urls[this._curType];

    var loadCallBack = this._loadCallBack.bind(this);

    switch (this._curType) {
      case 'SpriteFrame':
        // specify the type to load sub asset from texture's url
        cc.resources.load(url, cc.SpriteFrame, loadCallBack);
        break;

      case 'Spine':
        // specify the type to avoid the duplicated name from spine atlas
        cc.resources.load(url, sp.SkeletonData, loadCallBack);
        break;

      case 'Font':
        cc.resources.load(url, cc.Font, loadCallBack);
        break;

      case 'Plist':
        cc.resources.load(url, cc.ParticleAsset, loadCallBack);
        break;

      case 'Animation':
      case 'Prefab':
      case 'Texture':
      case 'Txt':
      case 'Audio':
        cc.resources.load(url, loadCallBack);
        break;

      case 'Scene':
        cc.resources.loadScene(url, loadCallBack);
        break;

      case 'CORS':
        cc.assetManager.loadRemote(url, loadCallBack);
        this.loadTips.textKey = "CORS image should report texImage2D error under WebGL and works ok under Canvas";
        break;

      default:
        cc.assetManager.loadRemote(url, loadCallBack);
        break;
    }
  },
  _loadCallBack: function _loadCallBack(err, res) {
    this._isLoading = false;

    if (err) {
      cc.log('Error url [' + err + ']');
      return;
    }

    if (!(res instanceof cc.SceneAsset)) {
      this.assets.push(res.addRef());
    }

    this._curRes = res;

    if (this._curType === "Audio") {
      this._btnLabel.textKey = i18n.t("cases/05_scripting/07_asset_loading/AssetLoading.js.2");
    } else {
      this._btnLabel.textKey = i18n.t("cases/05_scripting/07_asset_loading/AssetLoading.js.3");
    }

    this._btnLabel.textKey += this._curType;
    this.loadTips.textKey = this._curType + " Loaded Successfully!";
  },
  _onClear: function _onClear() {
    this.showWindow.removeAllChildren(true);

    if (this._audioSource && this._audioSource instanceof cc.AudioSource) {
      this._audioSource.stop();
    }
  },
  _onShowResClick: function _onShowResClick(event) {
    if (this._curType === "Scene") {
      cc.director.runScene(this._curRes);
      return;
    }

    this._createNode(this._curType, this._curRes);
  },
  _createNode: function _createNode(type, res) {
    this.loadTips.textKey = "";
    var node = new cc.Node("New " + type);
    node.setPosition(0, 0);
    var component = null;

    switch (this._curType) {
      case "SpriteFrame":
        component = node.addComponent(cc.Sprite);
        component.spriteFrame = res;
        break;

      case "Texture":
      case "CORS":
        component = node.addComponent(cc.Sprite);
        component.spriteFrame = new cc.SpriteFrame(res);
        break;

      case "Audio":
        component = node.addComponent(cc.AudioSource);
        component.clip = res;
        component.play();
        this._audioSource = component;
        this.loadTips.textKey = i18n.t("cases/05_scripting/07_asset_loading/AssetLoading.js.4");
        break;

      case "Txt":
        component = node.addComponent(cc.Label);
        component.lineHeight = 40;
        component.string = res;
        break;

      case "Font":
        component = node.addComponent(cc.Label);
        component.font = res;
        component.lineHeight = 40;
        component.string = "This is BitmapFont!";
        break;

      case "Plist":
        component = node.addComponent(cc.ParticleSystem);
        component.file = res;
        component.resetSystem();
        break;

      case "Prefab":
        var prefab = cc.instantiate(res);
        prefab.parent = node;
        prefab.setPosition(0, 0);
        break;

      case "Animation":
        var loadAnim = cc.instantiate(this.loadAnimTestPrefab);
        loadAnim.parent = node;
        loadAnim.setPosition(0, 0);
        var AanimCtrl = loadAnim.getComponent(cc.Animation);
        AanimCtrl.addClip(res);
        AanimCtrl.play(res.name);
        break;

      case "Spine":
        component = node.addComponent(sp.Skeleton);
        component.skeletonData = res;
        component.animation = "walk";
        node.y = -248;
        break;
    }

    this.showWindow.addChild(node);
  }
}, _cc$Class["onDestroy"] = function onDestroy() {
  this.assets.forEach(function (x) {
    return x.decRef();
  });
  this.assets = null;
}, _cc$Class));

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9jYXNlcy8wNV9zY3JpcHRpbmcvMDZfYXNzZXRfbG9hZGluZy9Bc3NldExvYWRpbmcvQXNzZXRMb2FkaW5nLmpzIl0sIm5hbWVzIjpbImkxOG4iLCJyZXF1aXJlIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJzaG93V2luZG93IiwiTm9kZSIsImxvYWRBbmltVGVzdFByZWZhYiIsIlByZWZhYiIsImxvYWRUaXBzIiwiTGFiZWwiLCJsb2FkTGlzdCIsInR5cGUiLCJhc3NldHMiLCJvbkxvYWQiLCJfY3VyVHlwZSIsIl9sYXN0VHlwZSIsIl9jdXJSZXMiLCJfYnRuTGFiZWwiLCJfYXVkaW9Tb3VyY2UiLCJfaXNMb2FkaW5nIiwiX3VybHMiLCJBdWRpbyIsIlR4dCIsIlRleHR1cmUiLCJGb250IiwiUGxpc3QiLCJTcHJpdGVGcmFtZSIsIkFuaW1hdGlvbiIsIlNjZW5lIiwiU3BpbmUiLCJDT1JTIiwiX29uUmVnaXN0ZXJlZEV2ZW50Iiwib25EZXN0cm95IiwiaSIsImxlbmd0aCIsIm9uIiwiRXZlbnRUeXBlIiwiVE9VQ0hfRU5EIiwiX29uQ2xpY2siLCJiaW5kIiwiZXZlbnQiLCJfb25DbGVhciIsInRhcmdldCIsIm5hbWUiLCJzcGxpdCIsIl9vblNob3dSZXNDbGljayIsInRleHRLZXkiLCJ0IiwiZ2V0Q2hpbGRCeU5hbWUiLCJnZXRDb21wb25lbnQiLCJfbG9hZCIsInVybCIsImxvYWRDYWxsQmFjayIsIl9sb2FkQ2FsbEJhY2siLCJyZXNvdXJjZXMiLCJsb2FkIiwic3AiLCJTa2VsZXRvbkRhdGEiLCJQYXJ0aWNsZUFzc2V0IiwibG9hZFNjZW5lIiwiYXNzZXRNYW5hZ2VyIiwibG9hZFJlbW90ZSIsImVyciIsInJlcyIsImxvZyIsIlNjZW5lQXNzZXQiLCJwdXNoIiwiYWRkUmVmIiwicmVtb3ZlQWxsQ2hpbGRyZW4iLCJBdWRpb1NvdXJjZSIsInN0b3AiLCJkaXJlY3RvciIsInJ1blNjZW5lIiwiX2NyZWF0ZU5vZGUiLCJub2RlIiwic2V0UG9zaXRpb24iLCJjb21wb25lbnQiLCJhZGRDb21wb25lbnQiLCJTcHJpdGUiLCJzcHJpdGVGcmFtZSIsImNsaXAiLCJwbGF5IiwibGluZUhlaWdodCIsInN0cmluZyIsImZvbnQiLCJQYXJ0aWNsZVN5c3RlbSIsImZpbGUiLCJyZXNldFN5c3RlbSIsInByZWZhYiIsImluc3RhbnRpYXRlIiwicGFyZW50IiwibG9hZEFuaW0iLCJBYW5pbUN0cmwiLCJhZGRDbGlwIiwiU2tlbGV0b24iLCJza2VsZXRvbkRhdGEiLCJhbmltYXRpb24iLCJ5IiwiYWRkQ2hpbGQiLCJmb3JFYWNoIiwieCIsImRlY1JlZiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBRUFDLEVBQUUsQ0FBQ0MsS0FBSDtFQUNJLFdBQVNELEVBQUUsQ0FBQ0UsU0FEaEI7RUFHSUMsVUFBVSxFQUFFO0lBQ1JDLFVBQVUsRUFBRUosRUFBRSxDQUFDSyxJQURQO0lBRVJDLGtCQUFrQixFQUFFTixFQUFFLENBQUNPLE1BRmY7SUFHUkMsUUFBUSxFQUFFUixFQUFFLENBQUNTLEtBSEw7SUFJUkMsUUFBUSxFQUFFO01BQ04sV0FBUyxFQURIO01BRU5DLElBQUksRUFBRVgsRUFBRSxDQUFDSztJQUZILENBSkY7SUFRUk8sTUFBTSxFQUFFO0VBUkEsQ0FIaEI7RUFjSTtFQUNBQyxNQUFNLEVBQUUsa0JBQVk7SUFDaEI7SUFDQSxLQUFLQyxRQUFMLEdBQWdCLEVBQWhCO0lBQ0EsS0FBS0MsU0FBTCxHQUFpQixFQUFqQjtJQUNBLEtBQUtDLE9BQUwsR0FBZSxJQUFmO0lBQ0EsS0FBS0MsU0FBTCxHQUFpQixJQUFqQjtJQUNBLEtBQUtDLFlBQUwsR0FBb0IsSUFBcEI7SUFDQSxLQUFLQyxVQUFMLEdBQWtCLEtBQWxCLENBUGdCLENBUWhCOztJQUNBLEtBQUtDLEtBQUwsR0FBYTtNQUNUQyxLQUFLLEVBQUUsbUJBREU7TUFFVEMsR0FBRyxF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LENBQUM7SUFBQSxPQUFJQSxDQUFDLENBQUNDLE1BQUYsRUFBSjtFQUFBLENBQXJCO0VBQ0EsS0FBS3pGLE1BQUwsR0FBYyxJQUFkO0FBQ0gsQ0F4TkwiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGkxOG4gPSByZXF1aXJlKCdpMThuJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNob3dXaW5kb3c6IGNjLk5vZGUsXG4gICAgICAgIGxvYWRBbmltVGVzdFByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBsb2FkVGlwczogY2MuTGFiZWwsXG4gICAgICAgIGxvYWRMaXN0OiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgYXNzZXRzOiBbXSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGN1ciBsb2FkIFRhcmdldFxuICAgICAgICB0aGlzLl9jdXJUeXBlID0gXCJcIjtcbiAgICAgICAgdGhpcy5fbGFzdFR5cGUgPSBcIlwiO1xuICAgICAgICB0aGlzLl9jdXJSZXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9idG5MYWJlbCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2F1ZGlvU291cmNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIC8vIGFkZCBsb2FkIHJlcyB1cmxcbiAgICAgICAgdGhpcy5fdXJscyA9IHtcbiAgICAgICAgICAgIEF1ZGlvOiBcInRlc3RfYXNzZXRzL2F1ZGlvXCIsXG4gICAgICAgICAgICBUeHQ6IFwidGVzdF9hc3NldHMvdGV4dFwiLFxuICAgICAgICAgICAgVGV4dHVyZTogXCJ0ZXN0X2Fzc2V0cy9QdXJwbGVNb25zdGVyXCIsXG4gICAgICAgICAgICBGb250OiBcInRlc3RfYXNzZXRzL2ZvbnRcIixcbiAgICAgICAgICAgIFBsaXN0OiBcInRlc3RfYXNzZXRzL2F0b21cIixcbiAgICAgICAgICAgIFNwcml0ZUZyYW1lOiBcInRlc3RfYXNzZXRzL2ltYWdlXCIsXG4gICAgICAgICAgICBQcmVmYWI6IFwidGVzdF9hc3NldHMvcHJlZmFiXCIsXG4gICAgICAgICAgICBBbmltYXRpb246IFwidGVzdF9hc3NldHMvc3ByaXRlLWFuaW1cIixcbiAgICAgICAgICAgIFNjZW5lOiBcInRlc3RfYXNzZXRzL3NjZW5lXCIsXG4gICAgICAgICAgICBTcGluZTogXCJzcGluZWJveS9zcGluZWJveVwiLFxuICAgICAgICAgICAgQ09SUzogXCJodHRwczovL2Rvd25sb2FkLmNvY29zLmNvbS90ZXN0LWNhc2UvbG9nby5wbmdcIixcbiAgICAgICAgfTtcbiAgICAgICAgLy8gcmVnaXN0ZXJlZCBldmVudFxuICAgICAgICB0aGlzLl9vblJlZ2lzdGVyZWRFdmVudCgpO1xuICAgIH0sXG5cbiAgICBvbkRlc3Ryb3kgKCkge1xuXG4gICAgfSxcblxuICAgIF9vblJlZ2lzdGVyZWRFdmVudDogZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubG9hZExpc3QubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMubG9hZExpc3RbaV0ub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLl9vbkNsaWNrLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9vbkNsaWNrOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzTG9hZGluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fb25DbGVhcigpO1xuXG4gICAgICAgIHRoaXMuX2N1clR5cGUgPSBldmVudC50YXJnZXQubmFtZS5zcGxpdCgnXycpWzFdO1xuICAgICAgICBpZiAodGhpcy5fbGFzdFR5cGUgIT09IFwiXCIgJiYgdGhpcy5fY3VyVHlwZSA9PT0gdGhpcy5fbGFzdFR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMuX29uU2hvd1Jlc0NsaWNrKGV2ZW50KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9idG5MYWJlbCkge1xuICAgICAgICAgICAgdGhpcy5fYnRuTGFiZWwudGV4dEtleSA9IGkxOG4udChcImNhc2VzLzA1X3NjcmlwdGluZy8wN19hc3NldF9sb2FkaW5nL0Fzc2V0TG9hZGluZy5qcy4xXCIpICsgdGhpcy5fbGFzdFR5cGU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9sYXN0VHlwZSA9IHRoaXMuX2N1clR5cGU7XG5cbiAgICAgICAgdGhpcy5fYnRuTGFiZWwgPSBldmVudC50YXJnZXQuZ2V0Q2hpbGRCeU5hbWUoXCJMYWJlbFwiKS5nZXRDb21wb25lbnQoXCJjYy5MYWJlbFwiKTtcblxuICAgICAgICB0aGlzLmxvYWRUaXBzLnRleHRLZXkgPSB0aGlzLl9jdXJUeXBlICsgXCIgTG9hZGluZy4uLi5cIjtcbiAgICAgICAgdGhpcy5faXNMb2FkaW5nID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLl9sb2FkKCk7XG4gICAgfSxcblxuICAgIF9sb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB1cmwgPSB0aGlzLl91cmxzW3RoaXMuX2N1clR5cGVdO1xuICAgICAgICB2YXIgbG9hZENhbGxCYWNrID0gdGhpcy5fbG9hZENhbGxCYWNrLmJpbmQodGhpcyk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5fY3VyVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAnU3ByaXRlRnJhbWUnOlxuICAgICAgICAgICAgICAgIC8vIHNwZWNpZnkgdGhlIHR5cGUgdG8gbG9hZCBzdWIgYXNzZXQgZnJvbSB0ZXh0dXJlJ3MgdXJsXG4gICAgICAgICAgICAgICAgY2MucmVzb3VyY2VzLmxvYWQodXJsLCBjYy5TcHJpdGVGcmFtZSwgbG9hZENhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ1NwaW5lJzpcbiAgICAgICAgICAgICAgICAvLyBzcGVjaWZ5IHRoZSB0eXBlIHRvIGF2b2lkIHRoZSBkdXBsaWNhdGVkIG5hbWUgZnJvbSBzcGluZSBhdGxhc1xuICAgICAgICAgICAgICAgIGNjLnJlc291cmNlcy5sb2FkKHVybCwgc3AuU2tlbGV0b25EYXRhLCBsb2FkQ2FsbEJhY2spO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnRm9udCc6XG4gICAgICAgICAgICAgICAgY2MucmVzb3VyY2VzLmxvYWQodXJsLCBjYy5Gb250LCBsb2FkQ2FsbEJhY2spO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnUGxpc3QnOlxuICAgICAgICAgICAgICAgIGNjLnJlc291cmNlcy5sb2FkKHVybCwgY2MuUGFydGljbGVBc3NldCwgbG9hZENhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ0FuaW1hdGlvbic6XG4gICAgICAgICAgICBjYXNlICdQcmVmYWInOlxuICAgICAgICAgICAgY2FzZSAnVGV4dHVyZSc6XG4gICAgICAgICAgICBjYXNlICdUeHQnOlxuICAgICAgICAgICAgY2FzZSAnQXVkaW8nOlxuICAgICAgICAgICAgICAgIGNjLnJlc291cmNlcy5sb2FkKHVybCwgbG9hZENhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ1NjZW5lJzpcbiAgICAgICAgICAgICAgICBjYy5yZXNvdXJjZXMubG9hZFNjZW5lKHVybCwgbG9hZENhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ0NPUlMnOlxuICAgICAgICAgICAgICAgIGNjLmFzc2V0TWFuYWdlci5sb2FkUmVtb3RlKHVybCwgbG9hZENhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRUaXBzLnRleHRLZXkgPSBcIkNPUlMgaW1hZ2Ugc2hvdWxkIHJlcG9ydCB0ZXhJbWFnZTJEIGVycm9yIHVuZGVyIFdlYkdMIGFuZCB3b3JrcyBvayB1bmRlciBDYW52YXNcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY2MuYXNzZXRNYW5hZ2VyLmxvYWRSZW1vdGUodXJsLCBsb2FkQ2FsbEJhY2spO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9sb2FkQ2FsbEJhY2s6IGZ1bmN0aW9uIChlcnIsIHJlcykge1xuICAgICAgICB0aGlzLl9pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY2MubG9nKCdFcnJvciB1cmwgWycgKyBlcnIgKyAnXScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKHJlcyBpbnN0YW5jZW9mIGNjLlNjZW5lQXNzZXQpKSB7XG4gICAgICAgICAgICB0aGlzLmFzc2V0cy5wdXNoKHJlcy5hZGRSZWYoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VyUmVzID0gcmVzO1xuICAgICAgICBpZiAodGhpcy5fY3VyVHlwZSA9PT0gXCJBdWRpb1wiKSB7XG4gICAgICAgICAgICB0aGlzLl9idG5MYWJlbC50ZXh0S2V5ID0gaTE4bi50KFwiY2FzZXMvMDVfc2NyaXB0aW5nLzA3X2Fzc2V0X2xvYWRpbmcvQXNzZXRMb2FkaW5nLmpzLjJcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9idG5MYWJlbC50ZXh0S2V5ID0gaTE4bi50KFwiY2FzZXMvMDVfc2NyaXB0aW5nLzA3X2Fzc2V0X2xvYWRpbmcvQXNzZXRMb2FkaW5nLmpzLjNcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYnRuTGFiZWwudGV4dEtleSArPSB0aGlzLl9jdXJUeXBlO1xuICAgICAgICB0aGlzLmxvYWRUaXBzLnRleHRLZXkgPSB0aGlzLl9jdXJUeXBlICsgXCIgTG9hZGVkIFN1Y2Nlc3NmdWxseSFcIjtcbiAgICB9LFxuXG4gICAgX29uQ2xlYXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zaG93V2luZG93LnJlbW92ZUFsbENoaWxkcmVuKHRydWUpO1xuICAgICAgICBpZiAodGhpcy5fYXVkaW9Tb3VyY2UgJiYgdGhpcy5fYXVkaW9Tb3VyY2UgaW5zdGFuY2VvZiBjYy5BdWRpb1NvdXJjZSkge1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9Tb3VyY2Uuc3RvcCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9vblNob3dSZXNDbGljazogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLl9jdXJUeXBlID09PSBcIlNjZW5lXCIpIHtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLnJ1blNjZW5lKHRoaXMuX2N1clJlcyk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jcmVhdGVOb2RlKHRoaXMuX2N1clR5cGUsIHRoaXMuX2N1clJlcyk7XG4gICAgfSxcblxuICAgIF9jcmVhdGVOb2RlOiBmdW5jdGlvbiAodHlwZSwgcmVzKSB7XG4gICAgICAgIHRoaXMubG9hZFRpcHMudGV4dEtleSA9IFwiXCI7XG4gICAgICAgIHZhciBub2RlID0gbmV3IGNjLk5vZGUoXCJOZXcgXCIgKyB0eXBlKTtcbiAgICAgICAgbm9kZS5zZXRQb3NpdGlvbigwLCAwKTtcbiAgICAgICAgdmFyIGNvbXBvbmVudCA9IG51bGw7XG4gICAgICAgIHN3aXRjaCAodGhpcy5fY3VyVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcIlNwcml0ZUZyYW1lXCI6XG4gICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbm9kZS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuc3ByaXRlRnJhbWUgPSByZXM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiVGV4dHVyZVwiOlxuICAgICAgICAgICAgY2FzZSBcIkNPUlNcIjpcbiAgICAgICAgICAgICAgICBjb21wb25lbnQgPSBub2RlLmFkZENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5zcHJpdGVGcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZShyZXMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkF1ZGlvXCI6XG4gICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbm9kZS5hZGRDb21wb25lbnQoY2MuQXVkaW9Tb3VyY2UpO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5jbGlwID0gcmVzO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5wbGF5KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9Tb3VyY2UgPSBjb21wb25lbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkVGlwcy50ZXh0S2V5ID0gaTE4bi50KFwiY2FzZXMvMDVfc2NyaXB0aW5nLzA3X2Fzc2V0X2xvYWRpbmcvQXNzZXRMb2FkaW5nLmpzLjRcIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiVHh0XCI6XG4gICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbm9kZS5hZGRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5saW5lSGVpZ2h0ID0gNDA7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnN0cmluZyA9IHJlcztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJGb250XCI6XG4gICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbm9kZS5hZGRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5mb250ID0gcmVzO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5saW5lSGVpZ2h0ID0gNDA7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnN0cmluZyA9IFwiVGhpcyBpcyBCaXRtYXBGb250IVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlBsaXN0XCI6XG4gICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbm9kZS5hZGRDb21wb25lbnQoY2MuUGFydGljbGVTeXN0ZW0pO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5maWxlID0gcmVzO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5yZXNldFN5c3RlbSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlByZWZhYlwiOlxuICAgICAgICAgICAgICAgIHZhciBwcmVmYWIgPSBjYy5pbnN0YW50aWF0ZShyZXMpO1xuICAgICAgICAgICAgICAgIHByZWZhYi5wYXJlbnQgPSBub2RlO1xuICAgICAgICAgICAgICAgIHByZWZhYi5zZXRQb3NpdGlvbigwLCAwKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJBbmltYXRpb25cIjpcbiAgICAgICAgICAgICAgICB2YXIgbG9hZEFuaW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmxvYWRBbmltVGVzdFByZWZhYik7XG4gICAgICAgICAgICAgICAgbG9hZEFuaW0ucGFyZW50ID0gbm9kZTtcbiAgICAgICAgICAgICAgICBsb2FkQW5pbS5zZXRQb3NpdGlvbigwLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgQWFuaW1DdHJsID0gbG9hZEFuaW0uZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgQWFuaW1DdHJsLmFkZENsaXAocmVzKTtcbiAgICAgICAgICAgICAgICBBYW5pbUN0cmwucGxheShyZXMubmFtZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiU3BpbmVcIjpcbiAgICAgICAgICAgICAgICBjb21wb25lbnQgPSBub2RlLmFkZENvbXBvbmVudChzcC5Ta2VsZXRvbik7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnNrZWxldG9uRGF0YSA9IHJlcztcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuYW5pbWF0aW9uID0gXCJ3YWxrXCI7XG4gICAgICAgICAgICAgICAgbm9kZS55ID0gLTI0ODtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNob3dXaW5kb3cuYWRkQ2hpbGQobm9kZSk7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveSAoKSB7XG4gICAgICAgIHRoaXMuYXNzZXRzLmZvckVhY2goeCA9PiB4LmRlY1JlZigpKTtcbiAgICAgICAgdGhpcy5hc3NldHMgPSBudWxsO1xuICAgIH1cbn0pO1xuIl19